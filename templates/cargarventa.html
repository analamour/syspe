{% extends 'layout.html' %}

{% block body %}
<div class="col-md-4 offset-md-4">
    <card class="body">
        <form action="/restar_stock_vendido" method="POST">
            <div class="form-group">
                <div class="form-group">
                    <div>
                        <select name="clienteSeleccionado" class="form-select">
                            <option selected>Seleccione un cliente</option>
                            {% for cliente in clientes %}
                                <option value="{{ cliente[0] }}">{{ cliente[1] }}</option>
                            {% endfor %}
                        </select>

                        <select name="codigoProducto" id="productoSelect" class="form-select">
                            <option selected>Elija el codigo del producto</option>
                            {% for producto in productos %}
                                <option value="{{ producto[0] }}" data-price="{{ producto[2] }}">{{ producto[1] }}</option>
                            {% endfor %}
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="cantidadInput" class="form-label">Cantidad</label>
                        <input type="number" class="form-control" id="cantidadInput" name="cantidad" min="1" placeholder="Introduce una cantidad">
                    </div>
                    <div id="precioProducto">Precio: $0.00</div>
                    <button type="submit" class="btn btn-success btn-block">Guardar</button>
                </div>
            </div>
        </form>
    </card>
</div>

<script>
    document.addEventListener("DOMContentLoaded", function() {
        var productoSelect = document.getElementById("productoSelect");
        var precioDiv = document.getElementById("precioProducto");

        productoSelect.addEventListener("change", function() {
            var selectedOption = this.options[this.selectedIndex];
            var precio = selectedOption.getAttribute("data-price");
            precioDiv.textContent = "Precio: $" + precio;
        });
    });
</script>
{% endblock %}
